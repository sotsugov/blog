---
layout: post
title: NVIDIA CUDA 8 and cuDNN 6 on Ubuntu 16 with GTX 1080
---
Many deep learning libraries use Nvidia GPU to accelerate the computation. The [CUDA Toolkit](https://developer.nvidia.com/cuda-toolkit) needs to install to make use of the GPU. The [NVIDIA CUDA Deep Neural Network library (cuDNN)](https://developer.nvidia.com/cudnn) is a GPU-accelerated library of primitives for deep neural networks which is worth installing. Current version of CUDA is 9 and current version of cuDNN is 7. But many deep learning libraries have yet to upgrade to the current versions of CUDA and cuDNN. So here I present a way to install CUDA 8 and cuDNN 6.

### Hardware
* CPU: Intel Core i7-6700K 4.0GHz Quad-Core Processor
* GPU: NVIDIA GeForce GTX 1080 Founders Edition
* Motherboard: Asus MAXIMUS VIII HERO ATX LGA1151 Motherboard

### Software
* Ubuntu 16.04.3 LTS
* Download [CUDA 8.0](https://developer.nvidia.com/cuda-toolkit) and install as follows:

```
wget http://developer.download.nvidia.com/compute/cuda/repos/ubuntu1604/x86_64/cuda-repo-ubuntu1604_8.0.61-1_amd64.deb
wget http://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1604/x86_64/libcudnn6_6.0.21-1%2Bcuda8.0_amd64.deb
wget http://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1604/x86_64/libcudnn6-dev_6.0.21-1%2Bcuda8.0_amd64.deb
sudo dpkg -i cuda-repo-ubuntu1604_8.0.61-1_amd64.deb
sudo dpkg -i libcudnn6_6.0.21-1+cuda8.0_amd64.deb
sudo dpkg -i libcudnn6-dev_6.0.21-1+cuda8.0_amd64.deb
sudo apt-get update
sudo apt-get install cuda=8.0.61-1
sudo apt-get install libcudnn6-dev
```

* Reboot the system to load the NVIDIA drivers.
* Set up the development environment by modifying the PATH and LD_LIBRARY_PATH variables, also add them to the end of `.bashrc` file:

```
export PATH=/usr/local/cuda-8.0/bin${PATH:+:${PATH}}
export LD_LIBRARY_PATH=/usr/local/cuda-8.0/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}
```

* Test the installation:

```
$ nvidia-smi
Tue Oct 31 16:57:41 2017
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 384.90                 Driver Version: 384.90                    |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  GeForce GTX 1080    Off  | 00000000:01:00.0  On |                  N/A |
| 27%   32C    P8     7W / 180W |    401MiB /  8105MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID   Type   Process name                             Usage      |
|=============================================================================|
|    0      1099      G   /usr/lib/xorg/Xorg                           212MiB |
|    0      1986      G   compiz                                       136MiB |
|    0      2660      G   /usr/lib/firefox/firefox                       2MiB |
|    0      2798      G   /usr/lib/firefox/firefox                       2MiB |
|    0      2800      G   /usr/lib/firefox/firefox                       2MiB |
|    0      2826      G   /usr/lib/firefox/firefox                       2MiB |
|    0      8686      G   ...-token=A717B8C29315CD3ED229FC6A1D179793    38MiB |
+-----------------------------------------------------------------------------+
```
